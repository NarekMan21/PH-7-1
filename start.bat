@echo off
chcp 65001 >nul
title PH-7-1 –î–∞—Ç—á–∏–∫ –ø–æ—á–≤—ã - –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
color 0A

echo.
echo ========================================
echo    PH-7-1 –î–∞—Ç—á–∏–∫ –ø–æ—á–≤—ã - –ó–∞–ø—É—Å–∫
echo ========================================
echo.

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è Node.js
where node >nul 2>&1
if %errorlevel% neq 0 (
    echo ‚ùå Node.js –Ω–µ –Ω–∞–π–¥–µ–Ω!
    echo.
    echo –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js —Å https://nodejs.org/
    echo.
    pause
    exit /b 1
)

echo ‚úÖ Node.js –Ω–∞–π–¥–µ–Ω
node --version
echo.

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
if not exist "node_modules\" (
    echo üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...
    echo.
    call npm install
    if %errorlevel% neq 0 (
        echo.
        echo ‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π!
        pause
        exit /b 1
    )
    echo.
    echo ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
    echo.
) else (
    echo ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
    echo.
)

REM –ü—Ä–æ–≤–µ—Ä–∫–∞, –Ω–µ –∑–∞–ø—É—â–µ–Ω –ª–∏ —É–∂–µ —Å–µ—Ä–≤–µ—Ä
netstat -ano | findstr ":3000" >nul 2>&1
if %errorlevel% equ 0 (
    echo ‚ö†Ô∏è  –ü–æ—Ä—Ç 3000 —É–∂–µ –∑–∞–Ω—è—Ç!
    echo.
    echo –í–æ–∑–º–æ–∂–Ω–æ, —Å–µ—Ä–≤–µ—Ä —É–∂–µ –∑–∞–ø—É—â–µ–Ω.
    echo –ó–∞–∫—Ä–æ–π—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç.
    echo.
    choice /C YN /M "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤—Å–µ —Ä–∞–≤–Ω–æ"
    if errorlevel 2 exit /b 0
    echo.
)

REM –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ
echo üöÄ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞...
echo.
start "PH-7-1 Backend Server" cmd /k "node backend.js"

REM –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
echo ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞...
timeout /t 3 /nobreak >nul

REM –û—Ç–∫—Ä—ã—Ç–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞
echo üåê –û—Ç–∫—Ä—ã—Ç–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞...
start http://localhost:3000/index.html

echo.
echo ========================================
echo ‚úÖ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω!
echo.
echo –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: http://localhost:3000/index.html
echo.
echo –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ –∑–∞–∫—Ä–æ–π—Ç–µ –æ–∫–Ω–æ "PH-7-1 Backend Server"
echo –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C –≤ —ç—Ç–æ–º –æ–∫–Ω–µ.
echo.
echo ========================================
echo.

REM –û–∂–∏–¥–∞–Ω–∏–µ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à–∏ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è
pause

